<div class="alert alert-info" ng-hide="userSession.authenticated">
    The work board is empty because you are not logged in. To login or signup, go <a href="#/join">here</a>.
</div>
<tabs>
    <pane heading="Confirm invoices">
        <div class="row-fluid">
            <div class="well span12 special">
                <small>Confirm the data on the invoices your clients request. After 30 days if possible an invoice using your default data will be generated else the payment will be refunded.</small>
            </div>
        </div>
        <accordion close-others="false">
            <accordion-group heading="Invoices that need verification" is-open="true">
                <invoicetable columns="[ 'worker_username', 'role', 'expiration', 'currency', 'amount' ]"
                              api="Working.invoices"
                              action="'requested_invoices'"
                              button-text="'Confirm invoices'"
                              button-action="confirmInvoices"
                              group-by="'title'"
                              selectable="1"></invoicetable>
            </accordion-group>
        </accordion>
    </pane>
    <pane heading="Download invoices">
        <div class="row-fluid">
            <div class="well span12 special">
                <small>Your invoices. We generated these on request of your clients.</small>
            </div>
        </div>
        <accordion close-others="false">
            <accordion-group heading="Invoices generated on your behalf" is-open="true">
                <invoicetable columns="[ 'worker_username', 'role', 'currency', 'amount' ]"
                              api="Working.invoices"
                              action="'reviewed_invoices'"
                              button-text="'Download invoices'"
                              button-action="downloadInvoices"
                              group-by="'title'"
                              selectable="1"></invoicetable>
            </accordion-group>
        </accordion>
    </pane>
    <pane heading="Tasks">
        <div class="row-fluid">
            <div class="well span12 special">
                <small>Tasks to which you can or did contribute.</small>
            </div>
        </div>
        <accordion close-others="false">
            <accordion-group heading="Tasks you can earn money on" is-open="true">
                <table ng-table="suggestedTasks" class="mobbrtable table table-striped table-checkbox" template-pagination="custom/pager">
                    <tbody ng-repeat="group in $groups">
                    <tr class="ng-table-group">
                        <td colspan="{{$columns.length}}">
                            <div ng-click="group.$hideRows = !group.$hideRows">
                                <span ng-class="{ 'icon-chevron-right': group.$hideRows, 'icon-chevron-down': !group.$hideRows }"></span>
                                <span ng-bind="group.value"></span>
                            </div>
                        </td>
                    </tr>
                    <tr ng-hide="group.$hideRows" ng-repeat="user in group.data" title="{{ user.title }}">
                        <td data-title="''">

                        </td>
                        <td sortable="title" data-title="'Title'" ng-bind="user.title"></td>
                        <td sortable="currency" data-title="'Currency'" ng-bind="userSession.user.currency_iso" class="currency"></td>
                        <td sortable="amount" data-title="'Pledge'" class="amount">
                            <span ng-bind="user.amount | mobbrcurrency"
                                  ng-class="{ 'text-error': user.amount < 0 }"
                                  class="nowrap"></span>
                        </td>
                    </tr>
                    </tbody>
                </table>
                <script type="text/ng-template" id="custom/pager">
                    <div class="ng-cloak">
                        <div ng-if="params.settings().counts.length" class="btn-group pull-right">
                            <button ng-repeat="count in params.settings().counts" type="button" ng-class="{ 'btn-primary': params.count() == count && pages.length > 1, 'disabled': pages.length < 2 || params.count() == count }" ng-click="params.count(count)" class="btn btn-mini">
                                <span ng-bind="count"></span>
                            </button>
                        </div>
                        <div class="btn-group">
                            <button ng-class="{ 'disabled': !page.active, 'btn-primary': page.number == params.page() && page.type != 'prev' && page.type != 'next' && page.type != 'more' }"
                                    ng-repeat="page in pages"
                                    ng-switch="page.type"
                                    class="btn btn-mini">
                                <span ng-switch-when="prev" ng-click="params.page(page.number)">&laquo;</span>
                                <span ng-switch-when="first" ng-click="params.page(page.number)"><span ng-bind="page.number"></span></span>
                                <span ng-switch-when="page" ng-click="params.page(page.number)"><span ng-bind="page.number"></span></span>
                                <span ng-switch-when="more" ng-click="params.page(page.number)">&#8230;</span>
                                <span ng-switch-when="last" ng-click="params.page(page.number)"><span ng-bind="page.number"></span></span>
                                <span ng-switch-when="next" ng-click="params.page(page.number)">&raquo;</span>
                            </button>
                        </div>
                    </div>
                </script>
            </accordion-group>
            <accordion-group heading="Tasks you earned money on" is-open="true">
                <table ng-table="historicTasks" class="mobbrtable table table-striped table-checkbox" template-pagination="custom/pager">
                    <tbody ng-repeat="group in $groups">
                    <tr class="ng-table-group">
                        <td colspan="{{$columns.length}}">
                            <div ng-click="group.$hideRows = !group.$hideRows">
                                <span ng-class="{ 'icon-chevron-right': group.$hideRows, 'icon-chevron-down': !group.$hideRows }"></span>
                                <span ng-bind="group.value"></span>
                            </div>
                        </td>
                    </tr>
                    <tr ng-hide="group.$hideRows" ng-repeat="user in group.data" title="{{ user.title }}">
                        <td data-title="''">
                            <img ng-src="https://secure.gravatar.com/avatar/{{ user['gravatar'] }}?s=20&default=https://mobbr.com/img/default-gravatar.png"
                                 class="gravatar small img-rounded"
                                 width="20"
                                 height="20">
                        </td>
                        <td sortable="username" data-title="'Username'" ng-bind="user.username"></td>
                        <td sortable="datetime" data-title="'Date'" ng-bind="user.datetime"></td>
                        <td sortable="roles" data-title="'Role'" ng-bind="user.roles" class="roles"></td>
                        <td sortable="currency" data-title="'Currency'" ng-bind="userSession.user.currency_iso" class="currency"></td>
                        <td sortable="amount" data-title="'Amount'" class="amount">
                            <span ng-bind="user.amount | mobbrcurrency"
                                  ng-class="{ 'text-error': user.amount < 0 }"
                                  class="nowrap"></span>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </accordion-group>
        </accordion>
    </pane>
</tabs>

