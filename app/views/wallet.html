<div class="alert alert-info" ng-hide="userSession.authenticated">
    The dashboard is empty because you are not logged in. To login or signup, go <a href="#/join">here</a>.
</div>
<tabs>
<pane heading="Payments">

    <div class="form-inline" style="margin-bottom: 20px;">
        <label for="searchEntries{{paymenttype}}">Search: </label>
        <input type="search" class="search-query" ng-model="searchentries" id="searchEntries{{paymenttype}}" >
    </div>

    <accordion close-others="false">
        <accordion-group heading="Unfinalized" is-open="true">
            <payments nodatatitle="No pending/unfinalized payments"
                      searchentries="searchentries"
                      paymenttype="unfinalized_payments"
                      showexpiresdate="false"
                      editable="true"></payments>
        </accordion-group>
        <accordion-group heading="Since last logout" is-open="true">
            <payments nodatatitle="No payments since last logout"
                      paymenttype="new_payments"
                      editable="false"
                      searchentries="searchentries"
                      showexpiresdate="false"></payments>
        </accordion-group>
        <accordion-group heading="Historic payments" is-open="true">
            <payments nodatatitle="No payments"
                      searchentries="searchentries"
                      paymenttype="payments"
                      editable="false"
                      showexpiresdate="false"></payments>
        </accordion-group>
    </accordion>
</pane>
<pane heading="Pledges">

    <div class="row-fluid">
        <div class="well span12 special">
            <small>You can delete (revoke) a pledge you made. We will send every participant currently listed for the task an email informing them of this event.</small>
        </div>
    </div>

    <div class="form-inline" style="margin-bottom: 20px;">
        <label for="searchEntries{{paymenttype}}">Search: </label>
        <input type="search" class="search-query" ng-model="searchentries" id="searchEntries{{paymenttype}}" >
    </div>

    <accordion close-others="false">
        <accordion-group heading="Pledges" is-open="true">
            <payments nodatatitle="No unclaimed payments"
                      paymenttype="unclaimed_payments"
                      editable="true"
                      searchentries="searchentries"
                      showexpiresdate="false"></payments>
        </accordion-group>
    </accordion>
</pane>
<pane heading="Balances">

    <div class="pull-right btn-toolbar" style="margin: 0;">
        <div class="btn-group">
            <button class="btn dropdown-toggle" data-toggle="dropdown">Deposit <span class="caret"></span></button>
            <ul class="dropdown-menu pull-right">
                <li class="nav-header">Currency and amount</li>
                <li class="nav-header">
                    <select class="input-small"
                            ng-model="$parent.$parent.deposit_currency"
                            ng-options="currency for currency in $parent.$parent.networks['iban'].currencies">
                    </select>
                    <input name="deposit_amount" class="input-small" ng-model="$parent.$parent.deposit_amount"
                           required type="number" step="any" min="0" max="1000000000">
                </li>
                <li class="nav-header">Note</li>
                <li class="nav-header">
                    <textarea name="deposit_note" ng-model="$parent.$parent.deposit_note"></textarea>
                </li>
                <li class="nav-header">
                    <button class="btn btn-success"
                            ng-click="deposit()">
                        <i class="icon-white mobbrloader" ng-show="waitingwithdraw"></i>
                        Deposit
                    </button>
                </li>
            </ul>
        </div>
        <div class="btn-group">
            <button class="btn dropdown-toggle" data-toggle="dropdown">Withdraw <span class="caret"></span></button>
            <ul class="dropdown-menu pull-right">
                <li class="nav-header">Payment method</li>
                <li class="nav-header">
                    <select ng-model="$parent.$parent.network_method"
                            ng-options="value.name for (key, value) in networks"></select>
                </li>
                <li class="nav-header">Currency and amount</li>
                <li class="nav-header">
                    <select class="input-small"
                            ng-model="$parent.$parent.network_method.send.currency"
                            ng-options="currency for currency in $parent.$parent.network_method.currencies">
                    </select>
                    <input name="withdraw_amount" class="input-small"
                           ng-model="$parent.$parent.network_method.send.amount"
                           required type="number" step="any" min="0" max="1000000000">
                </li>
                <li class="nav-header">Payment data</li>
                <li class="nav-header" ng-show="$parent.$parent.network_method == networks['iban']">
                    <div class="controls">
                        <input type="text" pattern="[a-zA-Z]{2}[0-9]{2}[a-zA-Z0-9]{4}[0-9]{7}([a-zA-Z0-9]?){0,16}"
                               placeholder="ÃBAN"
                               name="iban"
                               ng-model="$parent.$parent.network_method.send.address.iban"
                               required>
                    </div>
                    <div class="controls">
                        <input type="text" pattern="^[A-Z]{6}[A-Z0-9]{2}([A-Z0-9]{3})?$"
                               placeholder="BIC"
                               name="bic"
                               ng-model="$parent.$parent.network_method.send.address.bic"
                               required>
                    </div>
                    <div class="controls">
                        <input type="text" name="name"
                               placeholder="e.g. Patrick Savalle"
                               ng-model="$parent.$parent.network_method.send.address.name"
                               required>
                    </div>
                    <div class="controls">
                        <input type="text" name="address"
                               placeholder="e.g. ..."
                               ng-model="$parent.$parent.network_method.send.address.address"
                               required>
                    </div>
                </li>
                <li class="nav-header" ng-show="$parent.$parent.network_method == networks['btc']">
                    <div class="controls">
                        <input type="text" pattern="^[13][1-9A-Za-z][^OIl]{20,40}"
                               placeholder="Bitcoin address"
                               name="address"
                               ng-model="$parent.$parent.network_method.send.address"
                               required>
                    </div>
                </li>
                <li class="nav-header">Note</li>
                <li class="nav-header">
                    <textarea name="note" ng-model="$parent.$parent.network_method.send.note"></textarea>
                </li>
                <li class="nav-header">
                    <button class="btn btn-success"
                            ng-click="send()">
                        <i class="icon-white mobbrloader" ng-show="waitingwithdraw"></i>
                        Send
                    </button>
                </li>
            </ul>
        </div>
    </div>

    <div class="form-inline" class="pull-left" style="margin-bottom: 20px;">
        <label for="searchBalanceEntries">Search: </label>
        <input type="search" class="search-query" ng-model="searchBalanceEntries" id="searchBalanceEntries" >
    </div>

    <accordion close-others="false">
        <accordion-group heading="Total credit" is-open="true">

            <table class="table table-striped" ng-show="balances.length > 0">
                <thead>
                <tr>
                    <th>Currency description</th>
                    <th ng-click="sortBalance('currency_iso')">Currency</th>
                    <th ng-click="sortBalance('amount')">Total</th>
                    <th ng-click="sortBalance('fee')">Fee</th>
                    <th ng-click="sortBalance('spendable')">Spendable</th>
                </tr>
                </thead>
                <tbody>
                <tr ng-repeat="balance in balances | orderBy:sortEntries:sortOrderBalance | filter:searchBalanceEntries"  ng-class-odd="'odd'" ng-class-even="'even'">
                    <td ng-bind="currencyDescription(balance.currency_iso)"></td>
                    <td ng-bind="balance.currency_iso" class="currency"></td>
                    <td ng-bind="balance.amount" class="amount decorate-amount"></td>
                    <td ng-bind="balance.fee" class="amount decorate-amount"></td>
                    <td ng-bind="balance.spendable" class="amount decorate-amount"></td>
                </tr>
                </tbody>
            </table>

            <div ng-show="balances.length == 0">
                No balances found
            </div>
        </accordion-group>
        <accordion-group heading="Deposits and withdraws" is-open="true">
            <table class="table table-striped" ng-show="mutations.length >0">
                <thead>
                <tr>
                    <th ng-click="sortPayments('paiddatetime')">date</th>
                    <th ng-click="sortPayments('payment_service')" >Provider</th>
                    <th ng-click="sortPayments('currency_iso')">Currency</th>
                    <th ng-click="sortPayments('amount')">Amount</th>
                    <th ng-click="sortPayments('receive_address')" colspan="2">Address</th>
                </tr>
                </thead>
                <tbody>
                <tr ng-repeat="mutation in mutations | orderBy:sortEntries:sortOrderPayments | filter:searchBalanceEntries"  ng-class-odd="'odd'" ng-class-even="'even'">
                    <td ng-click="openExternalPayment(mutation.id)" ng-bind="mutation.paiddatetime || mutation.announceddatetime" class="datetime {{ !mutation.paiddatetime && 'muted' }}"></td>
                    <td ng-click="openExternalPayment(mutation.id)" ng-bind="mutation.payment_service"></td>
                    <td ng-bind="mutation.currency_iso" class="currency"></td>
                    <td ng-bind="mutation.amount" class="amount decorate-amount"></td>
                    <td ng-bind="mutation.receive_address" colspan="2"></td>
                </tr>
                </tbody>
            </table>
            <div ng-show="mutations.length == 0">
                No transactions found
            </div>
        </accordion-group>
    </accordion>
</pane>
<pane heading="Addresses">
    <div class="row-fluid">
        <div class="well span12 special">
            <small>Use these public addresses to receive money from external accounts / persons</small>
        </div>
    </div>
    <form class="form-horizontal">
        <div ng-repeat="(currency, addresses) in supportedCurrencies">

            <accordion close-others="false">
                <accordion-group heading="{{currency}} / {{currencyDescription(currency)}}" is-open="false">
                    <div ng-repeat="properties in addresses">
                        <div style="padding-bottom:10px;" ng-repeat="(property,value) in properties" class="controls-row">

                            <label ng-bind="property" class="control-label">

                            </label>
                            <div class="controls">
                                <input type="text" disabled="disabled" ng-model="value" class="input-xxlarge"/>
                            </div>

                        </div>
                    </div>
                    <div class="controls" ng-show="currency == 'BTC'">
                        <button ng-click="generateAddress(currency)"
                                ng-disabled=""
                                type="submit"
                                class="btn btn-success">
                            <i class="icon-white mobbrloader" ng-show=""></i>
                            Generate extra address
                        </button>
                    </div>
                </accordion-group>
            </accordion>
        </div>
        </div>
    </form>

</pane>
</tabs>

