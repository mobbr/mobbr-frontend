<div class="container">

    <div class="page-header">
        <h1>Claim payment<br><small>Check if someone already rewarded your url or email</small></h1>
    </div>

    <accordion class="claim-payment" close-others="false">
        <accordion-group heading="1/{{isUrl() && 3 || 2}}: Enter url or email address" is-open="step() == 1">

            <form class="input-group" ng-submit="retrieveUnclaimedPaynents()">
                <input class="form-control" type="text" placeholder="http://site.com or your@email.com" ng-model="claimpayment.url" maxlength="2048" id="url" name="url">
                <span class="input-group-btn">
                    <button class="btn" ng-click="retrieveUrl()">Check <i class="glyphicon mobbrloader" ng-show="workingCheck"></i></button>
                </span>
            </form>

        </accordion-group>
        <accordion-group heading="2/3: Place payment information" ng-if="step() >= 3 && isUrl()" is-open="step() == 3">

            <div ng-show="unclaimedPayments.length > 0">
                <form class="form-inline">
                    <label for="searchEntries">Search: </label>
                    <input type="search" class="search-query" ng-model="searchEntries" id="searchEntries">
                    <div class="pull-right">
                        <label for="showEntries">Entries: </label>
                        <select class="input-small" ng-model="showEntries" id="showEntries">
                            <option value="10">10</option>
                            <option value="25">25</option>
                            <option value="50">50</option>
                            <option value="100">100</option>
                            <option value="">All</option>
                        </select>
                    </div>
                </form>

                <table class="unclaimed-payments table">
                    <thead>
                    <tr>
                        <th ng-click="sortPayments('url')">URL</th>
                        <th ng-click="sortPayments('title')">Title</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr ng-repeat="payment in unclaimedPayments | filter:searchEntries | limitTo:showEntries | orderBy:sortEntries:sortOrder">
                        <td><a href="{{payment.url}}">{{payment.url}}</a></td>
                        <td ng-bind="payment.title"></td>
                    </tr>
                    </tbody>
                </table>
                <div ng-show="unclaimedPayments.length > showEntries">
                    showing {{showEntries}} from {{unclaimedPayments.length}} unclaimed payments
                </div>
            </div>

            <p>
                Place a <a href="#/integration#metadata">metatag</a> or <a href="#/integration#metalink">metalink</a>
                in the HTML-header of your page. Or place a <a href="#/integration/#domain">participation.txt</a>
                file in the root of your domain. Proceed if / after you did so. You can generate a metatag or metalink
                <a href="#/generatebutton">here</a>. For the full script protocol, look <a href="/protocol.html">here</a>
            </p>

            <button class="btn btn-success" ng-disabled="!claimpayment.url || loadingPaymentDescription" ng-click="retrievePaymentDescription()">
                Retrieve payment description
                <i class="glyphicon mobbrloader" ng-show="workingCheck"></i>
            </button>

        </accordion-group>
        <accordion-group heading="3/3: Verify payment information" ng-if="step() >= 4 && isUrl()" is-open="step() >= 4">

            <p>Mobbr found the following payment information on your URL: </p>
            <pre class="prettyprint pre-scrollable" ng-bind="paymentDescription"></pre>

            <button class="btn btn-success" ng-disabled="!paymentDescription || claiming" ng-click="claim()">
                Claim my URL's
                <i class="glyphicon mobbrloader" ng-show="claiming"></i>
            </button>

        </accordion-group>
        <accordion-group heading="2/2: Claim payments" ng-if="step() >= 4 && !isUrl()" is-open="step() == 4">

            <div ng-show="unclaimedPayments.length > 0">
                <form class="form-inline">
                    <label for="searchEntries">Search: </label>
                    <input type="search" class="search-query" ng-model="searchEntries" id="searchEntries">
                    <div class="pull-right">
                        <label for="showEntries">Entries: </label>
                        <select class="input-small" ng-model="showEntries" id="showEntries">
                            <option value="10">10</option>
                            <option value="25">25</option>
                            <option value="50">50</option>
                            <option value="100">100</option>
                            <option value="">All</option>
                        </select>
                    </div>
                </form>

                <table class="unclaimed-payments table">
                    <thead>
                    <tr>
                        <th ng-click="sortPayments('url')">URL</th>
                        <th ng-click="sortPayments('title')">Title</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr ng-repeat="payment in unclaimedPayments | filter:searchEntries | limitTo:showEntries | orderBy:sortEntries:sortOrder">
                        <td><a href="{{payment.url}}">{{payment.url}}</a></td>
                        <td ng-bind="payment.title"></td>
                    </tr>
                    </tbody>
                </table>
                <div ng-show="unclaimedPayments.length > showEntries">
                    showing {{showEntries}} from {{unclaimedPayments.length}} unclaimed payments
                </div>
            </div>

            To claim these payments, <a href="/#/join">create an account</a> with this same email address.

        </accordion-group>
    </accordion>
</div>